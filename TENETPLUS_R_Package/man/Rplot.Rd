% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Rplot.R
\name{Rplot}
\alias{Rplot}
\title{Plot Degree and Expression Correlation}
\usage{
Rplot(
  object,
  layer = "Trimm",
  degree_type = "outdegree",
  top_n = 5,
  return_df = FALSE
)
}
\arguments{
\item{object}{An object containing network data and gene expression data. It should include:
\itemize{
\item \code{object@output$result}: A list of data frames representing different network layers. The specified \code{layer} should be present here.
\item \code{object@input$count$rna_counts}: A matrix or data frame of gene expression counts with gene names as rownames.
}}

\item{layer}{Character. The name of the layer in \code{object@output$result} to be used. Default is \code{"Trimm"}.}

\item{degree_type}{Character. Specifies whether to compute \code{"outdegree"} or \code{"indegree"}.
For the \code{"Trimm"} layer, \code{"outdegree"} is computed using the \code{TF} column and \code{"indegree"} using the \code{TG} column.
For other layers, \code{"outdegree"} uses the \code{source} column and \code{"indegree"} uses the \code{target} column.
Default is \code{"outdegree"}.}

\item{top_n}{Numeric. The number of top nodes (by expression and degree) to highlight in the plot. Default is 5.}

\item{return_df}{Logical. If \code{TRUE}, the function returns a data frame containing the node names, degree, and expression values.
Otherwise, the function only prints the plot. Default is \code{FALSE}.}
}
\value{
A scatter plot is printed displaying the relationship between node degree and gene expression.
If \code{return_df} is \code{TRUE}, a data frame with columns \code{node}, \code{degree}, and \code{expression} is returned.
}
\description{
This function calculates the degree distribution from a specified layer in a regulatory network object and correlates it with gene expression levels.
It extracts the nodes from the layer, computes their degree (either outdegree or indegree), retrieves the corresponding gene expression data,
and then visualizes the relationship between degree and expression using a scatter plot. The top \code{top_n} nodes by expression and degree are highlighted.
}
\details{
The function operates as follows:
\enumerate{
\item Validates that the specified \code{layer} exists in \code{object@output$result}.
\item Extracts the relevant degree information based on the layer and \code{degree_type}.
\item Retrieves gene expression data from \code{object@input$count$rna_counts} for the unique nodes found in the degree calculation.
\item Aggregates and normalizes the expression data using \code{NormalizeData}.
\item Highlights the top \code{top_n} nodes based on both expression and degree.
\item Generates a scatter plot with \code{ggplot2} and uses \code{geom_text_repel} to label the highlighted nodes.
}
}
\examples{
\dontrun{
# Assuming 'net_obj' is a properly formatted object:
Rplot(net_obj, layer = "Trimm", degree_type = "outdegree", top_n = 5)
}

}

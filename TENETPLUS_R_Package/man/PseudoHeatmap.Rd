% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PseudoHeatmap.R
\name{PseudoHeatmap}
\alias{PseudoHeatmap}
\title{Generate Pseudotime Heatmaps for Transcription Factors (TF), Target Genes (TG), and Target Accessible Regions (TAR)}
\usage{
PseudoHeatmap(object, features, group = NULL, use_result = TRUE, span = 0.7)
}
\arguments{
\item{object}{A list or S4 object containing input and output data. Expected structure:
\itemize{
\item \code{object@input$count$rna_counts}: A matrix of RNA expression counts (rows: genes, columns: cells).
\item \code{object@input$count$atac_counts}: A matrix of ATAC accessibility counts (rows: peaks, columns: cells).
\item \code{object@input$metadata}: A data frame containing metadata with \code{pseudotime} and \code{select} columns.
\item \code{object@output$result$Trimm}: A data frame with TF-TG-TAR relationships.
}}

\item{features}{Character vector of transcription factors (TFs) to include in the heatmap.}

\item{group}{Character (optional). Specifies the grouping variable in \code{object@input$metadata} for heatmap annotation.}

\item{use_result}{Logical. If \code{TRUE}, includes target genes (TG) and target accessible regions (TAR) heatmaps. Default is \code{TRUE}.}

\item{span}{Numeric. The span parameter for LOESS smoothing. Default is \code{0.7}.}
}
\value{
Generates heatmaps showing pseudotime-ordered expression patterns of TFs, TGs, and TARs.
}
\description{
This function generates a pseudotime-ordered heatmap for selected transcription factors (TFs) along with their
target genes (TG) and target accessible regions (TAR) based on gene expression (RNA-seq) and chromatin accessibility (ATAC-seq) data.
}
\details{
The function performs the following steps:
\enumerate{
\item Extracts metadata and pseudotime information, filtering cells where \code{select == 1}.
\item Retrieves RNA expression data for selected TFs, standardizes it (Z-score transformation), and applies LOESS smoothing.
\item Generates a heatmap of TF expression over pseudotime.
\item If \code{use_result} is \code{TRUE}:
\itemize{
\item Extracts TG expression data, computes average expression across targets, and applies LOESS smoothing.
\item Extracts TAR accessibility data from ATAC-seq, processes it similarly to TG expression.
\item Generates heatmaps for TG and TAR.
\item Merges the TF, TG, and TAR heatmaps vertically (\code{\%v\%} operator).
}
\item If \code{group} is provided, adds cell-type annotation to the heatmap.
}
}
\examples{
\dontrun{
# Example usage:
PseudoHeatmap(object, features = c("FOXO1", "TP53"), group = "cell_type", use_result = TRUE, span = 0.7)
}

}
